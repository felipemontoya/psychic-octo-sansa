<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Choropleth</title>
  <style>

  .counties {
    fill: none;
  }

  .states {
    fill: none;
    stroke: #fff;
    stroke-linejoin: round;
  }

  .q0-9 { fill:rgb(247,251,255); }
  .q1-9 { fill:rgb(222,235,247); }
  .q2-9 { fill:rgb(198,219,239); }
  .q3-9 { fill:rgb(158,202,225); }
  .q4-9 { fill:rgb(107,174,214); }
  .q5-9 { fill:rgb(66,146,198); }
  .q6-9 { fill:rgb(33,113,181); }
  .q7-9 { fill:rgb(8,81,156); }
  .q8-9 { fill:rgb(8,48,107); }

  </style>
</head>
<body>
  <script src="src/vendor/d3.v3.min.js"></script>
  <script src="src/vendor/queue.v1.min.js"></script>
  <script src="http://d3js.org/d3.geo.projection.v0.min.js"></script>
  <script src="src/vendor/topojson.v1.min.js"></script>
  <script>

    var width = 960,
        height = 500;

    var rateById = d3.map();

    var quantize = d3.scale.quantize()
        .domain([0, .15])
        .range(d3.range(9).map(function(i) { return "q" + i + "-9"; }));

    var path = d3.geo.path();

    var svg = d3.select("body").append("svg")
        .attr("width", width)
        .attr("height", height);


    queue()
        // .defer(d3.json, "src/world-50m.json")
        .defer(d3.json, "src/us.json")
        .await(ready);

    function ready(error, topology) {
         svg.append("g")  
          .selectAll("path")
            .data(topojson.feature(topology,topology.objects.counties).features)  //us
            // .data(topojson.feature(topology,topology.objects.countries).features) // world-50m
          .enter().append("path")
            .attr("class", "land")
            .attr("d", path)
    }

  </script>
</body>  
</html>